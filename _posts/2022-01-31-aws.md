---
layout: post
author: Bruce Lee
title: AWS 아키텍트
---

## 클라우드 컴퓨팅의 3대 배포 모델
1) 올 인 클라우드 : AWS 와 같은 클라우드 서비스 제공자를 통해 어플리케이션을 배포하는 방식을 퍼블릭 클라우드 또는 올 인 클라우드 라고 부른다. 전부 클라우드에 위탁하는 방법을 생각하면 된다.
2) 하이브리드 클라우드 : 앱의 일부는 퍼블릭 클라우드에, 나머지는 온프레미스 환경에서 제공하는 방식이다. 일시에 클라우드로 이전하기 어려우므로 이러한 전략을 이용해 마이그레이션을 진행한다.
3) 온프레미스 또는 프라이빗 클라우드 : 가상화나 자원 관리도구를 이용해 자체 데이터센터에 앱을 배포하는 경우를 가리킨다. 일부 클라우드로 수용하기 어려운 경우 직접 데이터 센터 등을 구축한다.

## AWS 태동과 발전
- 2006년 AWS 는 잉여 컴퓨팅 용량을 서비스화해 제공함으로써 확장성 높은 AWS 의 초기 모델을 만들어서 공식 출범했다.
- 리전이란 AWS 의 클라우드 서비스용 데이터 센터 클러스터가 위치한 물리적인 장소이며 AWS 서비스가 제공되는 지리적 위치를 나타낸다.
- 각 리전에는 AZ 라 부르는 가용영역 (Availability Zones) 이 존재한다.
  - 하나의 AZ 는 한 개에서 여섯 개의 데이터 센터로 구성된다.
  - 하나의 AZ 가 셧다운되더라도 인접한 다른 AZ에 동일한 피해가 가지 않도록 한다.
  - Region 은 3 ~ 4 개의 AZ 으로 구성된 지역 개념이다.
- 엣지 로케이션 (POP : Points Of Presence) 이란 주로 CDN 즉, 콘텐츠 배포 네트워크로 사용되며 인근 사용자에게 고성능의 서비스를 제공할 수 있게한다.

## AWS 공유 보안 모델
- AWS 는 공유 보안 모델을 따르고 있는데, 이는 클라우드 자체의 보안은 AWS 가 맡고, 클라우드 내의 보안은 고객이 맡는다는 의미다.
- 즉, AWS 는 데이터 센터, 비디오 감시, 하드웨어, 서버, 스토리지, 가상화 자원, 네트워킹 등 물리적 보안을 책임지고, 고객은 애플리케이션과 호스팅하는 데이터에 대한 보안을 책임진다.

# AWS 스토리지 서비스
- 카테고리
1) 객체 스토리지 : 문서, 이미지, 비디오 등 을 저장하는 스토리지로 API 호출에 따라 사용자에게 콘텐츠르 공유 가능하다. (ex. S3)
2) 블록 스토리지 : 서버 인스턴스에 디스크 볼륨 형태로 제공되는 데이터를 통해 EC2 인스턴스에 포함된 볼륨에 고속으로 접근할 수 있다. 대표적 서비스인 EBS(Elastic Block Storage) 는 EC2 인스턴스를 위한 부트 볼륨(OS설치) 및 데이터베이스로 널리 사용된다.
3) 파일 스토리지 : 공유파일을 서버를 통해 공유하는 서비스로, 공유 폴더의 개념이며 로컬 파일 시스템처럼 작동한다.

## S3 (Amazon Simple Storage Service)
- S3 는 객체 스토리지이자, 저장 용량은 무제한이며, 99.99999999999 % 에 이르는 고신뢰성을 제공한다.
- 1GB 저장 시 한달에 $0.025 비용이 소요되며 저장가능한 양은 무제한이나 버킷은 100개로 제한된다
- 주요 장점으로는 간편성, 확장성, 신뢰성, 보안성 등이 있으며 연간 99.99%의 가용성을 지니도록 설계되었다. (등급 및 서비스에 따라 약간씩 다르다)
- AWS 스토리지 서비스로는 S3, Glacier 등이 있으며 정적 웹사이트 호스팅, 콘텐츠 배포, 데이터레이크 등으로 활용된다.
- 객체를 공유하기 위한 URL 은 https://[버킷이름].s3.[리전이름].amazonaws.com/파일명 으로 지정되기 때문에 버킷은 고유한 이름이어야 한다.
- S3 의 기본 인터페이스는 REST API 이며, HTTPS 모드에서 SOAP API 를 지원한다.
  - SOAP(Simple Object Access Protocol)는 그 자체로 프로토콜이며, 보안이나 메시지 전송 등에 있어서 REST보다 더 많은 표준들이 정해져있기 때문에 조금 더 복잡하다 (은행 등에서 사용)

### S3 스토리지 클래스 (비즈니스 니즈에 따라 다양한 스토리지 클래스 제공)
- Amazon S3 Standard : AWS 의 기본형 스토리지로 빈번하게 접근하는 데이터를 위한 스토리지이다, 인출비용은 없으나 저장비용이 싸다. (콘텐츠, 웹사이트, 분석용데이터, 모바일앱 등으로 사용)
  - 99.99% 의 가용성을 보장하며, 세 개의 시설에 비동기적으로 복제돼 저장되며, 두 개의 시설에서 데이터가 손실돼도 문제가 없도록 설계됐다.
- Amazon S3 Standard IA : Infrequent Access 의 약자로, 저장비용은 Standard 의 반값이나 약간의 인출비용이 있어 백업, 재해대비에 사용된다.
- Amazon S3 One Zone-IA : 한 군데의 AZ 에서만 저장하는 서비스로, 가용성이 조금 떨어지지만 비용이 약간 더 저렴하다. 99.95% 의 가용성을 제공한다.
- Amazon S3 Intelligent-Tiering : 데이터 액세스 패턴에 따라 (자동으로 빈도에 따라 Tier 를 이동) 다른 스토리지로 이동시켜 비용을 최적화한다.
- Amazon S3 Glacier : 데이터 장기보관을 목적으로 활용된다.
  - Instant Retrieval : 분기당 한 번 데이터에 액세스하는 경우 IA 대비 최대 68%의 스토리지 비용을 절감
  - Flexible Retrieval (구 Glacier) : 즉각적인 액세스가 필요하지 않지만 (수십분 ~ 수시간) 비용 없이 큰 데이터 집합을 검색하는 유연성이 필요한 아카이브 데이터(예: 백업 또는 재해 복구 사용 사례)
- Amazon S3 Glacier Deep Archive : 인출하는데 최소 4시간이 소요될 수 있으며 법규 등에 의해 7년 ~ 10년간 보관해야하는 경우 해당 장기 아카이브 스토리지가 유용할 수 있다. (내구성 99.999999999%, 데이터 복원에 최대 12시간 소요)

### S3 객체 버전 관리 (버저닝)
- 버저닝은 동일한 파일의 다양한 업데이트 상태를 관리하는 방법이다.
- 실수로 특정 파일을 삭제하거나 업데이트 한 경우, 직전 버전의 파일이 필요할 수 있는데, 이때 버저닝이 보험과 같은 역할을 담당한다.

### S3 객체 라이프 사이클 관리 ( 수명주기 규칙)
- 파일 이동 : 서로 다른 클래스 간에 객체를 이동시키는 규칙을 추가할 수 있다. 예를 들어 로그 파일 생성 후 일주일 경과 시 S3-IA 클래스로 이동시키는 것이다
- 파일 소멸 : 객체가 소멸된 후의 사항을 정의할 수 있다. 예를 들어, S3 에서 파일을 삭제한 경우, 삭제한 파일을 일정 기간 임시 보관하는 규칙을 추가할 수 있다.
- 백업 파일을 몇 년간 보관할지 혹은 특정 기간이 지난 파일을 S3 -> S3-IA -> S3 Glacier -> S3 Glacier Deep Archive 로 옮기는 규칙을 작성할 수 있다.

### S3 복제
- S3 복제 기능을 이용해 S3 버킷에 저장된 모든 파일을 복사하고 다른 버킷에 자동으로 저장할 수 있다.
- AWS 는 S3 복제를 두 가지 유형으로 제공한다.
  - 교차 리전 복제(CRR, Cross Region Replication) : 서로 다른 리전 간의 객체 복제에 사용된다. (외국으로 파일을 복제하는 경우 개인정보보호법 등을 고려해야함)
  - 동일 리전 복제(SRR, Same-Region Replication) : 동일 리전 내에서 객체 복제에 사용되며 객체 단위로 다른 AZ 에 복사하는 것을 말한다. (동기복제 가능)
<br/>
> 교차리전 복제 시 주의사항
> 1) 소스와 타깃 버킷에 버저닝 기능이 활성화돼 있어야 한다.
> 2) 복제에 사용할 타깃 리전을 지정해야 한다
> 3) S3 파일 복제를 위한 퍼미션 롤이 있어야 한다.
> 4) 소스 버킷에 Object Lock 이 활성화돼 있는 경우, 타깃 버킷도 Object Lock 이 활성화돼 있어야 한다.
> 5) 타깃 버킷 오너는 소스 버킷 오너에게 객체 복제 퍼미션을 부여해야 한다.
- 교차 리전 복제의 경우는 거리가 멀어서 동기화는 어려워 비동기로 복제되며 일반적으로 잘하지 않는다.
  <br/>
### S3 Glacier
- Glacier 는 장기보관 백업을 위한 저비용 클라우드 스토리지이며, 인출비용이 있으므로 입출력이 없는 경우에 적합하다
- Glacier 는 Glacier 와 Glaicer Deep Archive 두 가지 유형이 있으며 다양한 산업에서 다음과 같이 활용된다
<br/>
1. 자기 테이프 스토리지 대체
2. 헬스케어/생명과학/과학 데이터 저장 (주로 장기저장하는 데이터)
3. 미디어 자산 아카이빙/디지털 보관 (평소 미활용하는 영상 등)
4. 규제 정책에 따른 아카이빙/장기 백업 보관
<br/>
- 아카이브는 데이터를 위한 금고 역할을 수행하는 볼트(Vault) 에 저장된다.
- 볼트는 S3 의 버킷과 비슷한 개념의 저장소이자 아카이브용 컨테이너라 할 수 있다.
- 법정증거(포렌식) 으로 활용해야하는 경우, 볼트 잠금 정책에 WORM(Write Once Read Many) 규칙을 추가해 다른 사용자의 편집 또는 수정을 막을 수 있다.

### EBS (Elastic Block Store)
- EBS는 EC2 인스턴스를 위한 영구 스토리지 기능을 수행한다. (EC2 인스턴스의 수명주기를 넘어서서 존재 가능)
- EBS 볼륨은 고가용성, 고신뢰성 스토리지 볼륨으로 EC2 인스턴스의 부트 파티션으로 사용되거나 서버를 위한 하드 드라이브와 같은 기능을 수행하게 된다.
- 즉, 서버의 HDD 처럼 동작하며 부트볼륨, 데이터베이스를 설치할 수 있고 데이터 볼륨을 별도로 관리할 수 있어 편리하다
- EBS 는 볼륨에 대한 특정 시점의 스냅샷을 지속적으로 작성해 S3 에 저장하는 방식으로 다수의 AZ 에서 자동 복제 기능을 제공한다.
- HDD 보다 더 빠른 SSD 를 사용할 수 있고, 더 빠른 Provisioned IOPS SSD 를 사용할 수 도 있다. (IO 성능이 중요한 워크로드에 사용하며 성능 예측가능하며 일관성 요구에 맞는 볼륨 타입이다.)

### EBS 특징
- 영구 스토리지 : EC2 인스턴스의 수명주기와 독립적인 생애주기를 갖는다.
- 범용성 : 특정 포맷 형식을 따르지 않는 블록 스토리지로 어떤 OS 에서도 사용할 수 있다.
- 고가용성 및 고신뢰성 : EBS 볼륨은 특정 컴포넌트 실패 시 동일 AZ 내에서 자동으로 복제하는데, 서로 다른 AZ 간에는 복제되지 않으며 동일 AZ 내 다른 서버 간에는 복제가 가능하다.
- 암호화, 다양한 저장 용량, 사용 편의성, 실패 대응성을 제공한다.
- EBS HDD-기반 볼륨은 낮은 빈도의 입출력 및 저렴한 비용에 초점을 맞춘 콜드 HDD 와 중요한 워크로드를 위한 처리 성능 최적화 HDD 타입 등이 있다.

### EFS (Elastic File System)
- EFS 는 공유 파일 시스템으로서 다수의 인스턴스를 위한 공통 파일 시스템 역할을 수행할 수 있으며, 낮은 전송지연율로 다수의 인스턴스를 지원할 수 있다.
- EC2 인스턴스가 여러개인 경우, 파일 시스템이 다를 수 있다.
- EFS 는 호환성이 높고 (파일 시스템 인터페이스 제공 및 파일 시스템 액세스 시맨틱이 일반적인 파일시스템과 동일) 빠르다 (페타바이트 규모로 민첩하게 확장 가능)

### AWS Storage Gateway
- SGW 는 기존 환경에 가상머신 형태로 배포되며 이를 통해 기존의 애플리케이션, 스토리지 시스템, 디바이스를 스토리지에 연결할 수 있다.
- 표준 스토리지 프로토콜 인터페이스를 제공하므로 별다른 변경 작업 없이 기존의 앱에 연결할 수 있다.
- 게이트웨이는 온프레미스에서 AWS 로의 데이터 전송을 최적화하며 로컬 캐시로 전송 속도를 높여 애플리케이션에 원활하게 데이터를 공급할 수 있다.
- 다음 세 가지 스토리지 인터페이스를 지원한다.
  - 파일 게이트웨이 : S3 객체의 저장과 인출을 도우며 파일은 NFS 마운트 포인트를 통해 접근할 수 있다, 관련 메타데이터는 객체와 함께 S3에 저장된다.
  - 볼륨 게이트웨이 : 애플리케이션에 블록 프로토콜 기반의 디스크 볼륨을 제공한다, 캐시드 모드 (프라이머리 데이터는 S3 에 저장, 자주 접근하는 데이터는 로컬에 저장해 신속하게 참조) 또는 스토어드 모드 (전체 데이터는 로컬에 저장하고 비동기적인 백업 데이터만 S3 에 저장) 로 실행된다.
  - 테이프 게이트웨이 : 기존의 백업 애플리케이션과 워크플로우는 그대로 사용하고 필요에 따라 확장성을 지닌 가상 테이프를 추가해 사용하는 방식이다.

### Snowball 과 Snowmobile
- Snowball 은 페타바이트 규모의 데이터 이전을 위한 임포트/익스포트 도구다. 이를 이용하면 높은 보안성, 내충격성의 아마존 전용 NAS 디바이스를 활용할 수 있다.
- Snowmobile 은 엑사바이트 규모의 데이터 이전 서비스로 AWS 에 대규모 데이터를 임포트/익스포트하는데 사용된다.

# VPC (Virtual Private Cloud)
- Amazon VPC 는 사용자를 위한 Virtual Private Cloud 서비스로 클라우드를 퍼블릭과 프라이빗 영역으로 논리적으로 분리할 수 있게 해준다.
- VPC 로 기업의 데이터 센터를 연결하면 클라우드에 해당 기업을 위한 데이터 센터를 구축한 것과 같은 효과를 얻게 된다.
- VPC 를 이용해 인터넷에 연결하거나 데이터 센터에만 배타적으로 연결할 수 있다. 또한 자체 네트워크, 자체 서브넷/라우팅 규칙 등 모든 작업을 할 수 있다.
  * VPC 연결 방법
    * Direct connect : 기업에서 사용하는 데이터 센터와 VPC 를 연결해주는 서비스
    * Peering : VPC 와 VPC 를 연결하는 것
    * VPC 엔드포인트 : VPC 와 S3 를 연결하는 것 (S3 는 VPC 밖 AWS 클라우드 내 인터넷 구간에 있음)
- 이용자가 AWS 클라우드를 사용하는 단위와 같으며 서브넷을 여러개 만들 수 있고 서브넷 안에 EC2 인스턴스를 여러개 배포할 수 있다.
- VPC 는 하나의 거대한 기업용 네트워크인데 전체를 사설 IP 로 구성하게 되며 인터넷과 연결을 위해서는 가상의 네트워크 장치를 별도로 붙여야한다 (인터넷 게이트웨이, 라우터, NAT 게이트웨이 등)
- VPC 를 생성할 때는 최대 /16 (최대 65536개 할당 가능) 으로 네트워크를 설정 가능하며 동일 리전 내에서만 구현 가능하고 여러개의 가용영역에 걸쳐 사용 가능하다.
- Subnet 은 AZ 당 하나만 사용할 수 있고 VPC 보다 작게 설정한다. (/17 ~ /28)
- Public Subnet 에는 인터넷연결이 필요한 인스턴스들을 배치하며 Private Subnet 에는 인터넷 직접 연결이 필요없는 인스턴스들을 배치한다.

### 라우트 테이블
- 서브넷이 인터넷을 가능하게 해주는 가상의 장치로, 트래픽의 전송 방향을 결정하는 라우트와 관련된 규칙을 담은 테이블이다.
- 하나의 라우트 테이블만 있으면 여러 개의 서브넷 정보를 기록할 수 있다.

### 인터넷 게이트웨이
- 외부망(인터넷) 에서 내부망으로, 내부망에서 외부망으로 접속을 가능하게 하는 가상의 장치이다.
- 즉, VPC 가 인터넷으로 연결되도록 하는 요소이며, 라우트 테이블에 IG 와 관련된 엔트리만 추가하면 된다.

### 네트워크 주소 변환 (NAT)
- NAT 는 내부망에서 외부망으로 접속은 가능하나 반대로 접속은 안되는 공유기와 비슷한 기능을 한다.
- VPC 전체가 모두 사설 IP 로 되어있는 경우, NAT Gateway 나 인스턴스가 필요하다
- DB 등 외부접속은 필요 없으나 업데이트가 필요한 경우에 사용된다.
  - NAT 인스턴스 : 하나의 인스턴스가 NAT 기능을 해주는 것으로 몇대 만 인터넷에 연결하는 경우이다.
  - NAT 게이트웨이 : 네트워크 전체가 인터넷을 이용해야 하는 경우이다.
- NAT 게이트웨이를 사용하려면 먼저 일래스틱 IP (EIP : 퍼블릭고정 IP = 공인고정 IP) 주소 부터 설정한다.
- 프라이빗 서브넷의 라우트 테이블 엔트리에 NAT 인스턴스 대신 NAT 게이트웨이를 추가하면 인터넷에 연결된다.

### 외부 전용 인터넷 게이트웨이 (IPv6 용 NAT 장치)
- IPv6 기반 인터넷 트래픽의 이동을 담당하며, 외부 전용은 IPv6 서브넷 내부에서 외부로 나가는 아웃바운드만 가능하다는 뜻이다.

### 탄력적 네트워크 인터페이스(ENI)
- 가상의 랜카드와 같은 네트워크 인터페이스로 필요할 때 인스턴스에서 분리하고 해당 인스턴스나 다른 인스턴스에 다시 붙일 수 있다.
- MAC 주소가 들어있어 MAC 주소에 IPv4 또는 IPv6 를 연결해서 사용할 수 있다.

### 일래스틱 IP 주소
- IP 를 고정적으로 사용해야 할 경우, (ex, 도메인 네임에 연결하는 경우) 주로 웹서버 또는 로드밸런서에 배치한다.
- EIP 를 사용하면 EC2 인스턴스의 IP 주소가 변경될 때마다 EIP 가 해당 EC2 인스턴스를 가리키게 하면 되며, 애플리케이션은 같은 EIP 로 연결될 수 있다.
- EIP 는 정적 IP 주소이며 애플리케이션에 정적 IP 주소가 필요하다면 EIP를 사용하면 된다, 현 시점에서는 IPv4 만 지원한다.
- 계정당 5개 까지 사용가능하며 더 필요할 경우 요청한다.
- 퍼블릭 서브넷에 있는 경우에는 유동적 공인 ip 가 배정된다, 이를 해제하고 EIP 를 할당할 수 있으며 원래 인스턴스는 사설 IP에만 있는 경우에도 EIP 를 맵핑하면 외부에서 접속이 가능해진다.

### 시큐리티 그룹
- 일종의 OS 방화벽으로 VPC 에서 실행되는 어떤 인스턴스에도 할당할 수 있는 가상 방화벽이다. (주로 인스턴스에 배치)
- Stateful(상태기반) 을 지원하여 내부망에서 요청된 응답은 외부에서 들어오는 것을 허용한다. (State table 에 트래픽 정보를 기록하고 유지하는 방식)
- 인바운드는 모두 거부상태에서 특정 포트를 허용하는 방식이며 아웃바운드는 모두 허용한다.

### NACL (Network 기반의 Access Control List)
- ACL 은 패킷에 대한 허용이나 거부를 설정해놓은 목록이다. (네트워크 방화벽)
- 허용도 있고 거부도 있으며 번호가 높을수록 우선순위가 낮고 번호가 낮을수록 우선순위가 높다.
- 위에서부터 내려가면서 적용하기 때문에 (번호) 20 또는 30 단위 부여가 효과적이다
- Stateless 로 트래픽 맥락을 이해하지 않는다.

> - 시큐리티 그룹은 인스턴스 레벨에 적용되고 NACL 은 서브넷 레벨에 적용된다.<br/>
> - 시큐리티 그룹은 허용 규칙만 추가할 수 있지만 NACL 은 허용 거부 모두 가능하다.<br/>
> - 시큐리티 그룹의 모든 규칙은 트래픽 허용 전에 평가받지만, NACL 은 순번에 따른 우선순위로 평가받는다.<br/>

### VPC 피어링 : VPC 와 VPC 를 1대 1 로 연결하는 것이다.
### VPC 엔드포인트
- VPC 와 S3 를 연결하기 위한 가상의 장치로, 아마존 내에서 트래픽으로 연결된다. (외부망 X)
- 다른 장치가 따로 필요하지 않으며 수평적 확장성, 중복구현성, 고가용성을 제공한다.
- Private Link 를 이용하면 퍼블릭 IP 의 화이트리스트를 작성하거나 방화벽 프록시를 관리할 필요가 없다.

### Transit Gateway : 여러개의 VPC 를 연결할 때 피어링으로는 한계가 있어 만들어졌으며, VPC 와 온프레미스 네트워크를 연결하거나 VPC, VPN, AWS Driect Connect 게이트웨이, Transit Gateway 피어링 연결 객체를 리소스에 추가할 수 있다.
### 커스토머 게이트웨이 : 기업 고객 데이터센터로 연결하는 앵커와 같은 역할을 담당하는 연결장치이다.
### AWS Direct Connect : 기업 데이터 센터에서 VPC 로 연결되는 전용 프라이빗 연결 서비스이다.
### 기본 VPC 는 인터넷 게이트웨이에 연결돼있으며 인스턴스만 생성하면 자동으로 인터넷이 연결 가능하다.

# EC2 인스턴스
## Elastic Compute Cloud
- 가상머신 서버를 임대해주는 서비스로 대표적인 Iaas 이다. (Amazon Linux 를 OS 로 제일 많이 사용)
- 아마존의 책임은 Hardware, Hypervisor, Network, OS 설치 범위이다.
- 이용자의 책임은 OS 패치, Application 설치 및 관리, 데이터 관리 범위이다.
- 인스턴스 타입은 가상머신의 스펙으로, 제공 CPU 는 AWS 에서 제시하는 스펙이다.
- 윈도우, Debian, SUSE, CentOS, Red Hat, Ubuntu 등 운영체제 지원

### 네트워크 특징
- 배치 그룹(Placement group) 은 단일 AZ 내에서 인스턴스를 논리적 그룹으로 묶는 방법으로, 낮은 지연서오가 높은 수준의 네트워크 처리 성능을 제공한다.
- 최대 10Gbps 의 네트워크 처리 성능을 활용할 수 있다.
- 플레이스먼트 그룹을 생성하고 여기에 다수의 인스턴스를 론칭하면 된다.

### 스토리지 특징
- 범용 스토리지는 SSD 기반의 범용 EBS 볼륨으로 Flash Memory 전자식으로 속도가 빠르다.
- 프로비전 IOPS 스토리지는 DB 워크로드 실행 등 대량 IO 작업이 수반되는 컴퓨팅 작업에 사용된다.
- 마그네틱 스토리지는 (HDD) 기계식으로 속도가 느리나 비용이 가장 낮다.

### 가격정책
- 온디맨드 인스턴스 : 필요할때만 사용하며 후불이며 할인이 없다.
- 예약 인스턴스 : 약정으로 장기간 사용하며 선불/일부선불/후불을 선택할 수 있다.
- 스팟 인스턴스 : 가격을 소비자가 정하면 AWS 에서 가장 높은 금액을 제시한 순으로 EC2 를 제공한다. (경매식)
  - 급하지 않은 작업에서 사용하며, 사용한만큼 정산해서 종량제, 후불로 비용을 낸다.

### 공유 테넌시 : EC2 인스턴스를 론칭하면 기본적으로 적용되는 가상화 조건으로 EC2 인스턴스를 테넌시 하드웨어에서 실행한다. (온프레미스처럼 독점이 아닌 공유의 개념)
### 전용 호스트 : 특정 사용자에게만 배타적으로 할당된 물리적 서버이다.
### 전용 인스턴스 : VPC 자체를 별도로 사용하며, 단일 테넌트 하드웨어에서 EC2 인스턴스를 실행하며 개발 사용자에게만 할당된 VPC 에서 인스턴스를 실행한다.
  - 베어 메탈 인스턴스는 전용 인스턴스를 활용하는 방법이 되곧 한다. 하이퍼바이저가 없는 인스턴스로 서버의 프로세서 및 메모리 자원에 직접 접근할 수 있다는 장점이 있다.
### AMI (Amazon Machine Image) : 아마존에서 미리 만들어놓은 OS 를 설치한 가상머신 이미지이다.
  - 오토 스케일링을 사용하는 경우, 자신이 미리 만들어놓은 이미지를 새로 시작하는 인스턴스에서 실행한다.
### 인스턴스 루트 볼륨 : 인스턴스 부팅을 위한 이미지가 포함돼 있으며, 인스턴스가 실행되는 한 인스턴스 스토어 볼륨에 있는 모든 데이터는 유지되지만, 인스턴스가 삭제되면 모든 데이터도 사라진다. 인스턴스 스토어 기반의 인스턴스는 중지 동작이 지원되지 않는다 !

## 인스턴스 라이프 사이클
- 아마존은 정지 상태의 인스턴스는 과금하지 않는다, 데이터는 EBS 볼륨에 들어있으므로 볼륨에 대한 요금도 부과된다.
- 사용자는 인스턴스를 중단한 후 다시 시작하면서 인스턴스 타입을 업그레이드 할 수 있다.
- 인스턴스에 삭제 보호 기능이 활성화돼 있으면 추가로 몇 가지 작업을 하거나 환경 설정에서 삭제 보호 기능을 비활성화해야 한다.
- 퍼블릭 서브넷에서 인스턴스를 런칭하면 나오는 Public DNS(IPv4) 는 IP주소.리전이름.compute.amazonaws.com 으로 나타나며 설정이 안된 상태에서 SSH 접속을 할때 사용할 수 있다.

### Amazon Elastic Container Service
- ECS 는 EC2 클러스터에서 도커 컨테이너를 관리할 수 있게 해주는 컨테이너 관리 서비스다.
- 컨테이너는 마이크로서비스 컨셉을 구현한 것으로 하나의 앱을 작은 요소로 세분화해 복잡성을 줄이고 동일 호스트에서 프로세스가 실행되는 동안에도 빠르게 개발 진도를 나갈 수 있도록 해준다.

# AWS IAM (신분 및 권한 관리)
- IAM 은 식별과 접속 관리 (Identify and Access Management) 서비스이다.
- 사용자에 따라 접근을 통제하고 적절한 권한을 부여하는 것이라고 보면 된다.

## 신분 인증
- 신분 인증이란 리소스에 접근하려는 사람이 누구인지 밝히기 위한 체계이다.
- 그룹화된 유저(federated Users) 를 이용하여 제 3자로부터 신분을 확인할 수 있다.
  - 마이크로소프트 액티브 디렉터리를 위한 AWS 디렉터리 서비스 등 비 SAML 방식도 지원한다.
  - 아마존, 구글, 페이스북 등 널리 알려진 인증 정보 제공자를 통해서 로그인하고, 이러한 사용자가 AWS 리소스에 대한 접근을 승인하는 것이라고 이해하면 된다.

## 권한 부여
- 어떤 사용자가 해당 리소스에서 어떤 일을 할지에 대한 규칙을 생성할 수 있게 해준다.
- 이를 통해 최소한의 권한부여 및 책임의 분리를 구현할 수 있다.
- JSON 으로 IAM 정책을 작성할 수 있으며 이때 Effect 는 권한 허용 여부, Resource 는 아마존 내 공식자원 이름을 넣으며 arn:aws:s3:::<Your_bucket_name> 과 같은 형식이다.
- 기본적으로 접근 승인 여부는 거부로 설정돼 있으며 명시적으로 접근을 허용해야 한다.

## 감사
- AWS CloudTrail 은 계정에서 일어나는 일을 기록하고 이에 대한 로그 파일을 S3 버킷에 저장하는 것으로, 감사증적 등에 사용된다.
- 기록하는 주요 행동은 6하원칙 중 왜를 제외한 언제, 어디서, 누가, 무엇을, 어떻게 에 대해 기록한다.

## 보안 자격증명 종류
- 보안자격 증명은 다음과 같은 종류가 있다.
  - IAM 유저네임과 패스워드
  - Email 주소와 패스워드
  - 액세스 키 (+ 시크릿 액세스 키)
  - 키 페어
  - 멀티 팩터 인증 (소유기반 + 지식기반)

### 임시 보안 자격 정보
- 단기간만 사용할 목적으로 활용되고 수 시간까지만 보안 자격으로서의 유효성이 유지된다.
- 개발자 등 임시 보안 자격 정보를 제공하는 경우에는 AWS 시큐리티 토큰 서비스(AWS STS) 를 사용할 수 있다.

### 이러한 유저들에 대한 관리를 할 때 root 계정이 아닌 어드민 권한을 사용하는 것을 권장한다. (풀 액세스 어드민 권한)

## 롤
- IAM 롤을 이용하면 유저 또는 서비스가 필요로 하는 리소스에 접근 승인 규칙을 추가할 수 있다.
- 사용자 계정에는 정책을 부여하고 App/Service(EC2, Beanstalk 등) 에는 Role 이 주어져 다른 EC2, S3 등을 사용할 권리를 부여한다고 생각하면 된다.

## AWS 공유 책임 모델
### 보안에 대한 AWS 측의 책임
- 다음은 AWS 측이 부담하는 책임의 종류이다.
  - 데이터 센터에 대한 물리적 보안
  - Amazon EC2 보안 : AWS 는 루트 유저를 위한 운영체제 호스팅에 대한 보안 책임이 있다. OS 호스팅 영역에 접근하려는 기업 고객 어드민은 미리 접근 권한을 얻은 뒤 반드시 멀티 팩터 인증 방식으로 로그인해야 하며 로그인 이후 모든 행동은 로그 및 감사 데이터로 기록된다.
    - 그러나 AWS 는 고객의 인스턴스 또는 게스트 OS 에 대한 접근 권한은 갖고 있지 않으며 이는 고객이 책임을 지는 영역이다.
  - 네트워크 보안
  - 환경 설정 관리
  - 고가용성 데이터 센터
  - 디스크 관리
  - 스토리지 디바이스 폐기

### 보안에 대한 고객 측의 책임
- 다음은 고객 측이 부담하는 책임의 종류이다.
  - 운영체제 : 게스트 OS 의 관리에 대한 책임 부담
  - 애플리케이션 : AWS 위에서 실행되는 모든 어플리케이션에 대한 관리 책임이 있다.
  - 방화벽 : 시큐리티 그룹을 통해 OS 레벨에 적절한 방화벽을 적용하고 NACL 을 이용해 보안 환경을 설정해야 한다.
  - 네트워크 환경 설정
  - 서비스 환경 설정
  - 자격 인증 및 계정 관리

## AWS 보안 제품 및 서비스
### AWS Secrets Manager : 기업 비밀을 관리하는 일
- 즉, 사용자에 의한 기업 비밀 관리, 인출, 데이터베이스 접근 권한 및 API 키의 순회 변경, 기업 비밀의 생애주기 관리 등 업무를 지원한다.
- 애플리케이션 실행 중단에 대한 부담 없이 비밀 객체를 순회 변경할 수 있고, 애플리케이션 개발에 대한 비밀 객체 노출 가능성 또한 줄여준다.
- 비밀의 사용여부를 모니터링 및 감사할 수 있으며 프로그램 방식으로 비밀을 인출할 수 있고, 사용자가 보유한 암호화 키를 통해 암호화해 보관 및 전달할 수 있다.

### Amazon GuardDuty
- 지능형 보안 위협 감지 서비스로 AWS 계정과 이에 연동된 애플리케이션 및 서비스를 모니터링하고 인공지능과 머신러능을 통해 보안 위협에 대해 지능적으로 대처한다.
- 위협이 감지되면 GuardDuty 콘솔 및 클라우드와치 이벤트를 통해 상세한 보안 경고 메시지를 전송한다.
- 공격자의 정찰 행위, 인스턴스에 대한 위협, 계정에 대한 위협과 같은 유형을 감지한다.

### Amazon Inspector
- EC2 인스턴스에 대해 사용자의 보안 환경 점검, 보안 위협 해소 방안 제시를 한다.
- 수천 가지 이상의 보안 위협 점검 라이브러리를 제공한다.

### Amazon Macie
- S3 에 저장된 데이터를 보호하며, 머신러닝 기법으로 개인식별정보(Personally Identifiable Information), 지적 재산 등을 파악 및 활용 방안을 도출한다.
- 지속적으로 특이한 데이터 접근 행위 감시 및 비인가 접근 또는 부적적한 데이터 노출 시 경고 메시지를 발송한다.

### AWS Certificate Manager : SSL/TLS 인증서를 (Transport Layer Security) 프로비전, 관리, 배포할 수 있다.
### AWS Web Application Firewall
- WAF 는 7계층에서 사용하는 웹 서버용 방화벽으로 SQL 인젝션 또는 스크립팅과 같은 전형적인 웹 트래픽 공격을 방어할 수 있는 규칙을 생성 가능하다.

### AWS Shield
- App 에 대한 DDoS 공격에 대응하기 위한 관리혀 서비스로 Standard 는 무료이고 Advanced 는 App 뿐만 아니라, Elastic Load Balancer, CloudFront, Route 53 등을 방어하기 위한 고차원 방어 기능을 제공한다.

### AWS CloudHSM
- 보안 키 스토리지 및 암호화 연산 기능을 제공하는 변조 저항성 하드웨어이다.
- AWS 클라우드 내의 키를 안전하게 생성하고 관리할 수 있다.

### AWS KMS
- Key Management Service 는 기업용 암호화 키를 중앙에서 통합 관리해주는 서비스로 디지털 서명 기법으로 활용되거나 비대칭 키를 통해 데이터를 검증하기도 한다.

## EC2 접근을 위한 IAM 롤
- EC2 인스턴스를 론칭할 때 일련의 승인 권한을 확보한 IAM 롤을 생성해 해당 인스턴스에 부착하면 자동으로 AWS 액세스 키를 이용해 EC2 인스턴스에 접근 가능하다.
- S3 Full Access 권한을 부여하면 Snapshot 을 S3에 저장할 수 있다.

# Auto Scaling
- Scale Out : 서버의 개수를 늘리는 것
- Scale In : 서버의 개수를 줄이는 것
- Scale Up : 서버의 스펙을 올리는 것
- Scale Down : 서버의 스펙을 내리는 것
- Auto Scaling : 자동으로 Scale Out/In 을 하는 것 (CPU 사용률을 지표로 하여 할 수 있다)

## Auto Scaling 의 장점
- 동적 스케일링 및 사용자 경험 향상
- 헬스 체크와 서버 플릿 관리 : 오토스케일링을 이용해 헬스 체크를 하는 과정에서 특정 인스턴스의 문제가 감지되면 자동으로 다른 인스턴스로 교체할 수 있다.
- 로드 밸런싱 : ELB 를 이용하여 로드 밸런싱을 할때 오토스케일링 그룹을 로드밸런서의 타겟 그룹으로 설정할 수 있다.
- 타겟 트래킹 : 사용자가 설정한 타깃 예를 들어 CPU 활용률 등에 맞춰 인스턴스 수를 자동으로 조정 가능하다.
- 예측적 확장 : ML 오토 스케일링을 이용해서 수요 예측치에 근거해 자동으로 확장 또는 축소가 가능하다.
  - 이러한 예측적 확장은 기업 애플리케이션에 대한 요구 수준이 높아지기 전에 예방적으로 리소스를 프로비전 할 수 있다는 장점이 있다.

## 실행 환경 설정
- 실행 환경 설정이란 일종의 템플릿으로 AMI 상세정보, 인스턴스 타입, 키 페어, 시큐리티 그룹 등 인스턴스에 대한 모든 정보를 담고 있다.
- 예를 들어, 오토 스케일링 그룹에서 C4 라지 인스턴스에 대한 실행 환경 설정 템플릿을 생성한 뒤 인스턴스를 새로 실행 시 4대의 C4 라지 인스턴스가 실행되게 할 수 있다.

## 스케일링 유형
- 인스턴스 레벨 유지 : 항상 실행 상태를 유지하고자 하는 인스턴스의 수를 정의할 수 있다.
- 수동 스케일링 : 직접 인스턴스를 추가 또는 삭제해야 한다.
- 요구별 스케일링 : 클라우드와치가 모니터링하는 주요 지표를 바탕으로 요구 수준에 맞춰 스케일링 규칙을 정하는 방식이다.
- 일정별 스케일링 : 트래픽 변화를 예측할 수 있고, 패턴을 파악하고 있다면 일정별 액션을 추가해 특정 시간대에 조정 액션을 취할 수 있다.
- 서버 수 조절을 위해 SNS (Simple Notification Service) 를 이용하거나 SNS 알림을 통해 스케일 업 다운 시기를 알려줄 수 있다.

### 심플 스케일링
- 단 하나의 지표를 사용하여 스케일링 정책을 구성하는 것을 말한다.

### 단계별 스케일링
- 좀 더 지표를 단계별로 세분화하여 스케일링하는 정책이다.

### 타겟 트래킹 스케일링 정책
- 미리 정의된 성능 지표를 이용하거나 커스텀 지표를 만들어서 타깃 값으로 설정한다.
- 내부적으로 오토 스케일링이 클라우드 와치 경고를 생성 및 모니터링하다가 경고가 발동하면 오토 스케일링 정책을 실행시키는 구조다.

## 로드 밸런서의 유형
### Network Load Balancer : 대부분 443(https) 에 대한 분산
- TCP 로드 밸런서라고도 부르며 4계층 주소인 Port 기반의 로드밸런서 이다.

### Application Load Balancer : 일종의 Proxy server 역할
- OSI 모델 레이어 7 에 해당하며 헤더로 받은 뒤 어디로 전송할지 결정한다. 즉, http 헤더를 보고 보낼 서버를 결정한다.
- 따라서 ALB 에서는 헤더 수정이 가능한데 IP 출발지 주소가 ALB 로 설정되는 것을 수정하기 위해 X-Forwarded-For 헤더에 필요한 정보를 삽입할 수 있다.
- 경로 기반 라우팅을 통해 HTTP 헤더의 URL 경로에 따라 클라이언트 요청을 라우팅 할 수 있다.

### Classic Load Balancer : 예전 서비스 사용자를 대상으로 하는 서비스이다.

### 헬스체크
- Initial : 로드 밸런서가 타깃 등록 과정에 있거나 타깃에 대한 초기 헬스 체크를 수행 중임.
- Healthy : 타깃은 건강함
- Unhealthy : 타깃이 헬스 체크에 반응하지 않거나 헬스 체크에 실패함.
- Unused : 타깃 그룹에 등록되지 않았고 리스너 규칙에서 사용되지 않았거나, 사용할 수 없는 AZ 에 존재함.
- Draining : 타깃의 등록이 해제 됐고 연결 해제 절차가 진행 중임.

### 다중 AZ 활용
- 다중 AZ 구조에서 하나의 AZ 가 다운되면 오토 스케일링을 이용해 즉각적으로 대응 할 수 있다.
- 크로스 존 로드 밸런싱은 처리 요청을 다중 AZ 간에 균등하게 분배하는 것이며 ALB의 기본 기능이므로 사용자가 수동으로 설정할 필요는 없다.
  - NLB 의 경우, 각 로드 밸런서 노드는 해당 AZ 에 등록된 타깃으로만 트래픽을 배분한다.
- 스티키 세션을 이용하면 로드 밸런서가 반복적인 요청을 동일한 EC2 인스턴스에 최대한 많이 전달하여 캐싱 데이터를 활용해 처리 성능을 높일 수 있다.
  - 스티키 세션이란 클라이언트 요청에서 출발지 IP,PORT / 목적지 IP,PORT / 프로토콜을 Hash 계산하여 일치하면 연결을 유지하는 것이다.
  
# AWS 애플리케이션 배포 및 모니터링
## AWS Lambda : 5분 이내에 실행되는 간단한 기능을 실행하는 컴퓨팅 서비스
- S3 버킷 이미지 업로드, Dynamo DB 갱신, 인앱 액티비티 등 애플리케이션의 각종 이벤트에 반응해 백엔드 코드를 실행하는 컴퓨팅 서비스다. (PaaS)
- 람다는 코드 사용량에 따라 비용이 과금된다.
- AWS 는 서버리스 서비스를 제공하기 위해 대규모의 EC2 서버 플릿 (같은 목적을 위해 구현된 동일한 서버들의 집단) 또는 서버 함대를 보유 및 운용 중이다.
- 람다의 경우, 개발자는 코드를 실행하기만 하면 되며, 그 뒤에 존재하는 백엔드 인프라는 관리하지 않는다는 의미에서 이들 서비스를 서버리스 서비스라 부른다.
- 사용자는 다수의 람다 함수를 병렬적으로 실행할 수 있다.
- 람다가 지원하는 네이티브 언어는 Java, Node.js, Python, C#, Go, PowerShell, Ruby 가 있다.
- 실시간 파일 데이터 처리, 실시간 스트림 데이터 처리, ETL(Extract, Transform, Load) 작업, Cron 대체, AWS Events 처리에 람다를 주로 사용한다.

## Amazon API Gateway : API 를 이용하려고 하는 경우
- API의 정의, 퍼블리싱, 배포, 유지, 모니터링, 확장에 이르는 모든 업무를 안전하게 처리할 수 있또록 하는 완전 관리형 API 서비스이다.
- 클라이언트는 표준 HTTPS 요청을 통해 해당 API 를 통합할 수 있다.
- Gateway 는 EC2, ECS, 람다, 온프레미스 환경에서 실행되는 모든 웹 애플리케이션과 연결할 수 있는 창구로서의 역할을 수행해, 데이터, 비즈니스 로직, 백엔드 기능 등에 신속하게 접근할 수 있다.
- REST API, Websocket API, HTTP API 를 지원한다.

## Amazon Kinesis : IOT 발생 데이터를 비롯해 온라인 게임 데이터, 애플리케이션 서버 로그 데이터, 클릭 트림 데이터 등 실시간 데이터를 분석, 처리하기 위한 서비스이다.
- 실시간 애플리케이션의 경우, 모니터링 -> 데이터 발생 -> Kinesis 로 처리하는 단계로 사용할 수 있다.

### Amazon Kinesis Data Streams
- 실시간 분석 서비스를 제공하며 웹사이트 클릭스트림, 신용카드 사용 등 금융거래, 소셜미디어 피드, IT 로그, 위치 추적 이벤트 등 테라바이트급 데이터를 저장 및 처리할 수 있다.

### Amazon Kinesis Data Firehose : 활동로그에서 부정 식별 등
- 스트리밍 데이터를 수집, 변환하여 활용하며 근실시간 분석이 가능하도록 한다.
- 사용자는 오직 데이터 전송 비용만을 부담하면 된다. (성능에 대한 SLA 모니터링)
- AWS 데이터 저장 서비스와 통합 가능하며 서버리스 데이터를 변환 가능하고 근실시간으로 처리할 수 있다는 장점이 있다.

### Amazon Kinesis Data Analytics : 실시간성의 스트리밍 데이터를 처리 및 분석하기 위한 가장 간단한 방법이며 표준 SQL 방식을 사용한다 !
- IOT 디바이스의 센서 등 실시간 데이터 소스 등을 분석하고 모니터링해 변화하는 고객의 니즈를 파악하고 새로운 사업 기회를 포착할 수 있다.

## Amazon Cloud Front : 글로벌 CDN 서비스로 저지연성과 고속전송 속성을 지닌 콘텐츠 배포 기능 제공
- 정적 콘텐츠 캐싱, 동적 콘텐츠 가속화 기능, DDoS 공격 대응, 강화된 보안성 제공, API 호출 가속화, 소프트웨어 배포, 비디오 스트리밍에 활용 가능하다.
- 엣지 로케이션라 부르는 글로벌 데이터 센터 네트워크를 통해 콘텐츠를 배포한다.
- 지역별 엣지 캐시를 사용한다.
- 원본 파일 위치를 나타내는 CloudFront 경로로 도메인 네임이 표시되어 Origin 에 접근한다.
- 오리진을 생성할 때 오리진의 퍼블릭 DNS 를 지정해야 한다.

## Amazon Route 53
- Amazon 의 관리형 DNS 서비스로 co.kr 제외한 대부분의 도메인을 등록 가능하다.
- UDP53(포트) : DNS Query & Response 하는 포트이며 TCP53 : Zone Transfer (DNS 리스트 전체를 전달하는 포트) 이다.
- A, AAAA, CNAME, PTR 등의 DNS 기록 타입을 지원한다.
- 가중치 라운드 로빈은 비율에 따라 다르게 IP 를 알려주는 라우팅 정책이며, 지연 기반 라우팅은 빠른쪽에 우선 전달하는 정책이다.
- 장애 대응 라우팅은 장애 발생 시, 정상적으로 작동중인 리전으로 라우팅하는 것이며 지역 DNS 라우팅은 사용자 지역에 따라 DNA 쿼리에 응답하도록 (다른 IP 주소에 응답하도록) 한다.

## WAF
- 침해 시도로부터 보호(SQL 인젝션 등) 하며 악성 요청에 대응하고 DDoS 공격을 방어(웹 DDoS 만 가능) 한다.
- WAF 의 보안 규칙 중 일반 규칙은 데이터 부분의 내용을 확인하고 특정 요청을 목표로 하는 조건만 허용한다.
- 비율 규칙은 5분 간격으로 비율 제한을 적용하고 요청의 횟수를 측정해 IP 차단 등 액션을 취하게 된다.

## Amazon Shield : 분산 DDoS 공격을 방어하기 위한 관리형 서비스 이다.

## Amazon SQS(Simple Queue Service)
- 메시지 큐는 서버 간 비동기적인 소통을 위한 양식이며 메시지 큐는 대규모 프로세싱 잡을 좀 더 작게 분할해 개별 요소가 서로 독립적으로 작동할 수 있도록 하며, 배치 잡의 실행 속도를 높이고 워크로드 처리 성능을 높일 수 있다.
- 메시지 큐는 클라우드 시스템의 여러 부분이 비동기적으로 서로 소통하고 업무를 조정하도록 도우며, 임시로 메시지를 저장하는 버퍼, 메시지의 수신 및 발신을 위한 연결 부분인 엔드포인트를 제공한다.
- 큐에 메시지를 넣는 소프트웨어를 메시지 프로듀서라 부르고 큐에서 메시지를 꺼내는 소프트웨어를 메시지 컨슈머라 부른다.
- SQS 큐에는 스탠다드 큐와 FIFO 큐 두 가지 타입이 있다.
  - 스탠다드 큐 : 최소 1회 메시지 전송을 보장하고 전송순서 보장 기능을 제공한다.
    - 가끔은 순서와 다른 메시지가 전송되기도 한다.
  - FIFO 큐 : 여러 번 전송해도 순서가 바뀌지 않는다는 장점이 있다.

## Amazon SNS (Simple Notification Service)
- SNS 는 먼저 토픽을 생성해 구독 주제를 정한다.
- 퍼블리셔라 부르는 배포자가 토픽에 메시지를 추가하면, 모든 구독자에게 해당 메시지를 전파한다.
- 구독자란 특정 토픽에 관심이 있으며, 해당 노티피케이션을 수신하고자 하는 클라이언트로 특정 토픽을 구독하거나 특정 토픽 소유자에 의해 구독 대상에 포함될 수 있다.
- 메시지는 다중 AZ 환경에 저장되므로 신뢰할 수 있다.
- HTTP/HTTPS, EMAIL, SMS, Lambda, SQS 등 다양한 전송 프로토콜을 지원한다.
- 메시지는 즉각 또는 지연 가능하며 푸시 기반 전송을 통해 구독자에게 자동으로 메시지를 전송할 수 있다.
- 클라우드 와치와 통합한 모니터링 기능으로 시각화 할 수 있으며 AWS 관리 콘솔, CLI, SDK API 등으로 접속할 수 있다.
- 텍스트 데이터의 경우 최대 256KB, SMS 의 경우, 최대 140bytes 의 데이터를 담을 수 있다.
- 용량 제한 초과 시 메시지 수를 늘려 전송하되 단어 전체를 기준으로 앞 단어와 뒤 단어 사이를 잘라서 전송한다.
- 토픽 생성, 토픽 구독, 토픽 배포 3단계로 간단히 이용 가능하다.

## Amazon Step Functions
- 애플리케이션을 상태 저장 및 관리를 위한 스테이트 머신으로 정의하고, 앱의 동작을 한데 모아 일련의 스텝으로 관리할 수 있도록 돕는다.
- 임무, 선택, 병렬, 대기, 실패, 성공, 전달, 맵 8가지 상태 타입을 제공한다.
- Simple Workflow 서비스를 대체하기 위해 만들어졌다.

## Amazon Elastic Beanstalk : 개발자를 위한 인터페이스 제공, 나머지는 AWS 에서 관리
- 사용자가 코드만 업로드하면 EC2, ECS, Auto Scaling, ELB 등 AWS 리소스에 대한 프로비전 업무를 대신 처리한다.
- 웹 애플리케이션 실행과 관련된 모든 인프라가 관리되므로 사용자는 인프라 관리에 신경쓰지 않아도 된다.
- 기업용 애플리케이션 (ERP,SCM,CRM 등) 을 AWS 에서 구현할 때 사용되며 App 과 데이터까지가 이용자의 책임이다.
- 환경 설정 파일로 JSON, YAML 포맷을 사용한다.

## AWS OpsWorks (PaaS)
- 옵스워크는 모든 유형과 규모의 애플리케이션 배포 및 운영을 돕는 환경 설정 관리 서비스로 애플리케이션의 신속한 환경 설정, 배포, 업데이터를 지원한다.
- Chef Automate, Puppet Enterprise, OpsWorks Stacks 등 세 가지 도구를 제공한다.
  - Chef Automate : 완전 관리형 Chef 서버이자 지속적 배포와 준수 규정 및 보안 사항에 대한 테스트를 위한 종합적인 자동화 도구이며, 노드와 노드별 상태 정보를 시각화한 사용자 인터페이스를 제공한다.
  - Puppet Enterprise : 관리형 서버이자 오케스트레이션, 자동화 프로비저닝, 추적 데이터 시각화 등 종합적인 워크플로우 자동화 도구이다.
    - 운영 업무에 대한 풀스택 자동화 기능을 제공한다.
  - OpsWorks Stacks : AWS 와 온프레미스 환경의 애플리케이션 및 서버 관리를 도우며, 사용자는 옵스워크 스택스를 통해 전체 애플리케이션을 다수의 레이어를 지닌 스택 형식으로 모델링할 수 있다.

## Amazon Cognito
- 다수의 모바일 디바이스에서 사용자를 좀 더 편리하게 관리할 수 있도록 도와주는 사용자 신원 증명 및 데이터 동기화 서비스다.
- 비인증 신원 증명 방식을 지원하며, 이 경우 사용자는 로그인 절차를 거치지 않고 모바일 앱을 사용한 뒤 퍼블릭 로그인 방식으로 자신의 프로필을 생성하면 관련 프로필 데이터를 빠짐없이 가져올 수 있다.

## Amazon Elastic MapReduce
- EMR 은 Hadoop 프레임워크 서비스를 제공한다.
- 클러스터에 몇 개의 노드를 추가할 것인지 어떤 인스턴스 타입을 사용할 것인지, 어떤 애플리케이션을 설치할 것인지만 생각하면 되며, 다른 프로비전 업무는 아마존이 처리한다.

## AWS CloudFormation
- AWS 리소스 스택의 프로비전 및 관리를 돕는다.
- AWS 리소스 스택을 프로비전 및 환경 설정하게 된다.
- 템플릿은 JSON 또는 YAML 포맷의 텍스트 파일이다.

## Amazon CloudWatch
- 모든 리소스를 모니터링하기 위한 서비스로, 주요 지표를 모니터링 하며 주요 성능 지표를 시각화 및 분석한다.
- 지표 수집 간격에 따라 보존 기간이 다르다.
  - 1분 데이터 포인트의 경우 15일간 보존
  - 5분 데이터 포인트의 경우 63일간 보존
  - 1시간 데이터 포인트 경우 15개월 또는 455일간 보존한다.

## AWS CloudTrail
- 감사증적 로그로 누가 언제 어디서 어떤 작업을 했는지 로그 데이터로 저장한다.
- 로그 파일 생성 시 해싱에 SHA-256을 적용하거나 디지털 서명에 RSA 및 SHA-256 을 적용해 로그 파일을 검증한다.

## AWS Config
- 리소스 환경 설정 히스토리를 감사 업무에 사용하거나 리소스 환경 설정의 변화를 알림 메시지로 전달할 수 있다.
- 시간 흐름에 따른 규정 변화 트렌드를 확인하고 규정 위반에 대해 평가할 수 있다.

## Amazon VPC Flow Logs
- VPC 네트워크 인터페이스의 IP 트래픽 정보를 수집한다.

## AWS Trusted Advisor
- 비용 최적화, 보안성, 장애 대응성, 성능, 서비스 용량 제한 관리의 기능이 있다.

## AWS Organizations
- 계정 관리 업무를 일원화, 간소화한다.
- 다수의 계정에서 AWS 서비스 이용을 중앙화된 방식으로 통제할 수 있다.

# AWS 데이터베이스
## RDS 개요
- 관계형 데이터베이스 호스팅 및 관리 서비스인 RDS 는 Aurora MySQL, MySQL, Aurora PostgreSQL, PostgreSQL, Oracle, SQL Server, MariaDB 와 같은 RDBMS 엔진을 사용할 수 있다.
- EC2 서버에서 데이터베이스를 호스팅 할 경우, AWS 가 OS 설치, 서버 유지 보수, 서버 랙 관리, 전원 관리, 냉각 관리 네트워크 관리 등 업무를 처리한다.
- 사용자는 OS 관리, RDBMS 설치에 필요한 OS 패치 설치, 데이터베이스 설치 및 유지 보수, 데이터베이스 및 애플리케이션 최적화와 같은 제반 업무를 맡게 된다.
- RDS 의 주요 장점은 인프라 관리가 불필요하고 즉각적인 프로비저닝이 가능하며 확장성 관리가 쉽다는 것이다.
  - 추가로 사용량만큼 비용을 부담하는 비용 효율성, 애플리케이션 간 호환성, 고가용성, 보안 유지와 같은 장점을 가지고 있다.
- 다음의 경우에 RDS 가 추천된다.
  - 비즈니스 본연의 가치에 집중하고 DB 관리 업무를 원치 않는 경우
  - 하이 레벨 튜닝 및 스키마 최적화 등의 업무만 처리하려는 경우
  - DB 관리 역량이 부족하고 푸시 기반 다중 AZ 복제 환경을 원하는 경우
  - 백업 및 복원 자동화를 원하는 경우
- 다음의 경우 EC2 가 추천된다
  - 운영체제 시스템에 대한 통제권을 원하는 경우
  - DB, 백업, 복제, 클러스터링 등에 대한 완전한 통제권을 원하는 경우
  - RDBMS 엔진의 주요 기능과 옵션이 RDS 와 맞지않고 성능이 제공 수준을 뛰어넘어야하는 경우

### 고가용성 구현
- 멀티 AZ 배포 : 데이터를 잃어버려서는 안되는 경우, 설정된 복원 소요 시간이 매우 촉박하거나 가동 정지 시간이 일절 허용되지 않는 경우, 멀티 AZ 환경에서 DB 를 배포해야 한다.
- 기본 DB 가 셧다운되는 상황을 대비해 가동 가능 상태에서 대기한다 (Hot-Standby)
- 다중 AZ 환경은 기본적으로 동기적 복제 기능을 제공하므로 데이터 손실 가능성이없다.

### 확장성 구현
- DB 인스턴스 타입을 변경하는 것으로 스케일 업, 다운을 할 수 있다
- AWS CLI 및 AWS API 를 이용해 확장성을 조절할 수 있다.

### 읽기 사본 활용
- 읽기 사본은 마스터 DB 의 read-only 복사본으로 이를 통해 read-only 트래픽의 부담을 줄이고 마스터 DB 는 중요한 트랜잭션 쿼리에 집중할 수 있다.
- 사용자가 다른 국가에 있는 경우 해당 국가 리전에 읽기 사본을 둬 트래픽 부담을 줄일 수 있다.
- 사용자는 다른 리전에 크로스 리전 읽기 사본을 생성할 수 있다.
- 리전 내 복제 는 마스터 DB 와 동일한 AZ 또는 다른 AZ 에 다수의 읽기 사본 생성 기능을 제공하며 RDS 지원하는 엔진에 의해 제공된다.
- 교차 리전 복제는 마스터가 위치한 리전과 다른 리전에 읽기 사본을 배포하는 것이다.

## RDS 에서의 보안성 구현
- VPC 내 에서 실행되는 DB 를 연결하는 방법은 다양하다.
  1) VPC 내에 구현된 데이터 센터를 VPN 으로 연결해 하이브리드 방식으로 연결할 수 있다
  2) Direct Connect 로 데이터 센터와 AWS 리전을 연결하면 일관된 성능의 연결 상태를 유지할 수 있다.
  3) 두 개의 VPC 를 피어 방식으로 연결한 뒤, 하나의 VPC 에는 애플리케이션을 두고 다른 VPC 에는 DB 를 두고 서로 연결할 수 있다.
  4) VPC 에 Internet gateway 를 부착하고, 이를 통해 DB 에 대한 퍼블릭 접근을 허용할 수 있다.
  5) 서브넷의 라우팅 테이블을 이용해 VPC 의 라우팅 방식을 정의할 수 있다.

## RDS 에서의 데이터 암호화
- 데이터가 존재하는 모든 영역에서 암호화가 이루어진다.
- Oracle 또는 SQL Server 에서 제공하는 기본 암호화 방식인 Transparent Database Encryption 을 사용하는 경우에도 RDS 의 암호화를 쓸 수 있지만 RDS 또는 TDE 중 한 가지 모드만 사용해야 하고 그렇지 않으면 성능 저하 현상이 생길 수 있다.
- KMS 는 암호화 키 생성 및 관리를 위한 서비스로 사용자는 키를 이용해서 데이터 암호화 및 복호화 기능을 사용할 수 있다.
- 데이터 암호화에 사용되는 키는 RDS 데이터 키(RDS 내 데이터 암호화), AWS KMS 마스터 키(데이터 키 암호화) 로 두 가지 계층 구조를 지닌다.
- RDS 이용 시 SSL 기법으로 데이터베이스를 이동하는 트래픽을 암호화할 수 있는 데이터 암호화 기능을 제공한다.

## 백업, 복구, 스냅샷
- RDS 엔진은 하루 한 번의 백업을 실행한다.
- 백업 보존 기간은 35일 이며 백업 보존 기간을 늘릴 수 있다.
- 스냅샷은 DB 백업의 또 다른 방법으로, 자동 일정 관리를 할 수 없으며 사용자가 직접 생성해야 한다.
- 스냅샷 생성 시에 수 초에서 수 분간 임시 IO 처리 능력이 제공된다.

## Amazon Aurora
- Amazon Aurora 는 클라우드에 최적화된 MySQL 및 PostgreSQL 호환 관계형 데이터베이스이다.
- 완전분산형 및 자가 진단형 스토리지 시스템을 통해 성능 및 신뢰성을 보장하고 가용성을 제공한다.
- 세 개의 서로 다른 AZ 에 있는 여섯 개의 서로 다른 스토리지 노드로 분리된 스토리지 레이어에 자동으로 데이터를 복제한다
  - 이는 별도의 비용 없이 데이터를 여섯 번 미러링한다는 측면에서 의미가 크다.
  - 데이터 가용성을 보장하기 위해 읽기 및 쓰기를 위한 쿼럼 시스템을 사용한다.
  - 동시에 모든 데이터는 S3 에 지속적으로 백업되며 오로라는 최대 15개 까지의 읽기 사본을 제공한다.
  - 주의할 점은 동기적으로 스토리지 레벨에서 데이터 복제를 진행한다는 점이다.
  - Aurora MySQL 성능은 일반적은 MySQL 엔진의 평균 다섯 배에 이른다.

## Redshift
- Redshift 는 관리형 데이터 웨어하우스 솔루션으로 비즈니스 인텔리전스 활동에 맞게 설계된다.
- 기업 조직에서 요구하는 데이터 처리 및 분석 성능을 강화하는데 주로 사용된다.
- 데이터 웨어하우스는 데이터 쿼리 및 분석에 초점을 맞추며 트랜잭션 데이터에서 히스토리 데이터를 비롯해 다양한 소스에서 가져온 의사결정 데이터를 포함한다.
- 데이터 웨어하우스는 온라인 분석 처리 시스템 (OLAP) 으로 부르기도 하며 읽기 중심의 데이터 처리 시스템이다.
- 아키텍처는 리더 노드와 컴퓨트 노드로 구성된다.
  - 리더 노드는 애플리케이션의 SQL 엔드포인트 역할을 하며 DB 기능 및 병렬적인 SQL 처리 업무를 조정하는 역할을 담당한다.
  - 컴퓨트 노드는 리더 노드 아래에 있으며 최대 128개를 생성할 수 있고 쿼리 처리 시 컴퓨트 노드가 실제 데이터를 처리하게 된다.
  - Redshift 클러스터는 싱글 노드 및 멀티 노드 클러스터 두 가지 타입이 있다.
  - 싱글 노드 클러스터는 리더 노드와 컴퓨트 노드를 하나의 노드가 모두 맡아서 처리하는 방식이다.
  - 멀티 노드 클러스터에서 리더 노드는 컴퓨트 노드와 분리돼 있으며 클러스터별로 하나의 리더 노드만 존재한다.
  - 멀티 노드 클러스터에서 데이터는 중복 구현을 위해 컴퓨트 노드에서 자동 복제되므로 특정 컴퓨트 노드가 다운돼도 스냅샷으로 복구할 필요가 없다.

### 네트워킹
- 클러스터 생성 시 어느 AZ 에 속할지 결정 할 수 있다.
- 퍼블릭 서브넷 선택 시 퍼블릭 IP 주소 (EIP) 를 제공하거나 직접 사용자를 위해 클러스터가 EIP 를 제공하도록 할 수 있다.
- 프라이빗 서브넷에서 실행하는 경우 인터넷에서 접근이 불가능하며 프라이빗 또는 퍼블릭 서브넷은 리더 노드를 통해서만 접근 가능하며 컴퓨트 노드는 별도의 VPC 에서 생성되므로 사용자는 컴퓨트 노드에 접근할 수 없다.

### 백업 및 복구
- 자동화된 백업은 RPO(Recovery Point Object) 즉, 복구 시점 목표에 따라 스냅샷을 생성하도록 할 수 있다.
  - RPO ? 어느 시점으로 돌아갈 수 있냐 하는 것으로 가장 최근으로 가야 소실 데이터가 최소화 되므로 백업 주기가 짧아야 한다는 것이다.
  - RTO ? 언제까지 복구 가능하냐는 것으로 빠른 복구를 해야 서비스가 가능하므로 중복 구성과 대체 장비, 장소를 활용한다.

### 데이터 배분 전략
1) KEY 배분의 경우, 정의된 열의 해시값인 배포 키에 따라 노드 슬라이스를 선택하며 자주 결합되는 테이블과 연결을 유지하도록 할 수 있다.
2) ALL 배분의 경우, 각 노드의 첫 번째 슬라이스에 전체 테이블의 복사본을 배분하며 스토리지양은 증가하며 속도가 느려지므로 결합은 자주하면서 소규모인 경우에 사용한다.
3) EVEN 배분의 경우, 라운드 로빈 알고리즘에 따라 모든 슬라이스에 골고루 배분되며 결합 및 합산 빈도가 낮으며 대규모일 때 사용한다.

## Dynamo DB
- 확장성 및 개발의 신속성을 제공하는 고성능의 완전 관리형 NoSQL 데이터베이스이다.
- 테이블 생성, 목표 처리 성능 설정, 저장 상태의 데이터 관리 등을 지원한다.
- 주요 사용 방식으로는 광고 서비스에서 브라우저의 쿠키 상태 정보 수집, 모바일 어플리케이션에서 데이터, 세션 상태 저장, 게임 애플리케이션에서 유저 환경 설정 및 어플리케이션 상태 및 플레이어 게임 상태 저장, 리얼리티 TV 쇼 및 광고에서 투표 데이터 저장, 대규모 웹사이트에서 세션 상태 또는 개인화 설정, 접근 제어 데이터 저장, 로그 데이터 저장 등이 있다.
- 장점으로는 확장성(자동 스케일업/다운), 관리형 서비스(프로비저닝,패칭,업데이트,DB관리,데이터 파티셔닝), 신속성, 일관된 성능(SSD 사용), 세분화된 접근 제어(IAM과 통합), 비용 효율성과 같은 장점이 있다.
- 테이블과 거의 유사한 열 집합으로 구성된다.
- 기본 키는 단일 속성 또는 두 개의 속성이 결합된 복합 속성으로 구성가능하며 기본 키는 모든 아이템에 반드시 존재하며 서로 구분될 수 있어야 한다.
- 테이블 내 각 아이템은 최대 400KB 이내 여야 한다.

### 일관성 모델
- 최종적 일관성의 읽기 : 최근 완료된 쓰기 결과를 반영하지 못할 수 있다.
- 강한 일관성의 읽기 : 읽기 요청에 대해 언제라도 최신의 쓰기 결과가 모두 반영된 결과를 성공적으로 반환한다.