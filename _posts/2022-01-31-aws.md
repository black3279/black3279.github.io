---
layout: post
author: Bruce Lee
title: AWS 아키텍트
---

## 클라우드 컴퓨팅의 3대 배포 모델
1) 올 인 클라우드 : AWS 와 같은 클라우드 서비스 제공자를 통해 어플리케이션을 배포하는 방식을 퍼블릭 클라우드 또는 올 인 클라우드 라고 부른다. 전부 클라우드에 위탁하는 방법을 생각하면 된다.
2) 하이브리드 클라우드 : 앱의 일부는 퍼블릭 클라우드에, 나머지는 온프레미스 환경에서 제공하는 방식이다. 일시에 클라우드로 이전하기 어려우므로 이러한 전략을 이용해 마이그레이션을 진행한다.
3) 온프레미스 또는 프라이빗 클라우드 : 가상화나 자원 관리도구를 이용해 자체 데이터센터에 앱을 배포하는 경우를 가리킨다. 일부 클라우드로 수용하기 어려운 경우 직접 데이터 센터 등을 구축한다.

## AWS 태동과 발전
- 2006년 AWS 는 잉여 컴퓨팅 용량을 서비스화해 제공함으로써 확장성 높은 AWS 의 초기 모델을 만들어서 공식 출범했다.
- 리전이란 AWS 의 클라우드 서비스용 데이터 센터 클러스터가 위치한 물리적인 장소이며 AWS 서비스가 제공되는 지리적 위치를 나타낸다.
- 각 리전에는 AZ 라 부르는 가용영역 (Availability Zones) 이 존재한다.
  - 하나의 AZ 는 한 개에서 여섯 개의 데이터 센터로 구성된다.
  - 하나의 AZ 가 셧다운되더라도 인접한 다른 AZ에 동일한 피해가 가지 않도록 한다.
  - Region 은 3 ~ 4 개의 AZ 으로 구성된 지역 개념이다.
- 엣지 로케이션 (POP : Points Of Presence) 이란 주로 CDN 즉, 콘텐츠 배포 네트워크로 사용되며 인근 사용자에게 고성능의 서비스를 제공할 수 있게한다.

## AWS 공유 보안 모델
- AWS 는 공유 보안 모델을 따르고 있는데, 이는 클라우드 자체의 보안은 AWS 가 맡고, 클라우드 내의 보안은 고객이 맡는다는 의미다.
- 즉, AWS 는 데이터 센터, 비디오 감시, 하드웨어, 서버, 스토리지, 가상화 자원, 네트워킹 등 물리적 보안을 책임지고, 고객은 애플리케이션과 호스팅하는 데이터에 대한 보안을 책임진다.

# AWS 스토리지 서비스
- 카테고리
1) 객체 스토리지 : 문서, 이미지, 비디오 등 을 저장하는 스토리지로 API 호출에 따라 사용자에게 콘텐츠르 공유 가능하다. (ex. S3)
2) 블록 스토리지 : 서버 인스턴스에 디스크 볼륨 형태로 제공되는 데이터를 통해 EC2 인스턴스에 포함된 볼륨에 고속으로 접근할 수 있다. 대표적 서비스인 EBS(Elastic Block Storage) 는 EC2 인스턴스를 위한 부트 볼륨(OS설치) 및 데이터베이스로 널리 사용된다.
3) 파일 스토리지 : 공유파일을 서버를 통해 공유하는 서비스로, 공유 폴더의 개념이며 로컬 파일 시스템처럼 작동한다.

## S3 (Amazon Simple Storage Service)
- S3 는 객체 스토리지이자, 저장 용량은 무제한이며, 99.99999999999 % 에 이르는 고신뢰성을 제공한다.
- 1GB 저장 시 한달에 $0.025 비용이 소요되며 저장가능한 양은 무제한이나 버킷은 100개로 제한된다
- 주요 장점으로는 간편성, 확장성, 신뢰성, 보안성 등이 있으며 연간 99.99%의 가용성을 지니도록 설계되었다. (등급 및 서비스에 따라 약간씩 다르다)
- AWS 스토리지 서비스로는 S3, Glacier 등이 있으며 정적 웹사이트 호스팅, 콘텐츠 배포, 데이터레이크 등으로 활용된다.
- 객체를 공유하기 위한 URL 은 https://[버킷이름].s3.[리전이름].amazonaws.com/파일명 으로 지정되기 때문에 버킷은 고유한 이름이어야 한다.
- S3 의 기본 인터페이스는 REST API 이며, HTTPS 모드에서 SOAP API 를 지원한다.
  - SOAP(Simple Object Access Protocol)는 그 자체로 프로토콜이며, 보안이나 메시지 전송 등에 있어서 REST보다 더 많은 표준들이 정해져있기 때문에 조금 더 복잡하다 (은행 등에서 사용)

### S3 스토리지 클래스 (비즈니스 니즈에 따라 다양한 스토리지 클래스 제공)
- Amazon S3 Standard : AWS 의 기본형 스토리지로 빈번하게 접근하는 데이터를 위한 스토리지이다, 인출비용은 없으나 저장비용이 싸다. (콘텐츠, 웹사이트, 분석용데이터, 모바일앱 등으로 사용)
  - 99.99% 의 가용성을 보장하며, 세 개의 시설에 비동기적으로 복제돼 저장되며, 두 개의 시설에서 데이터가 손실돼도 문제가 없도록 설계됐다.
- Amazon S3 Standard IA : Infrequent Access 의 약자로, 저장비용은 Standard 의 반값이나 약간의 인출비용이 있어 백업, 재해대비에 사용된다.
- Amazon S3 One Zone-IA : 한 군데의 AZ 에서만 저장하는 서비스로, 가용성이 조금 떨어지지만 비용이 약간 더 저렴하다. 99.95% 의 가용성을 제공한다.
- Amazon S3 Intelligent-Tiering : 데이터 액세스 패턴에 따라 (자동으로 빈도에 따라 Tier 를 이동) 다른 스토리지로 이동시켜 비용을 최적화한다.
- Amazon S3 Glacier : 데이터 장기보관을 목적으로 활용된다.
  - Instant Retrieval : 분기당 한 번 데이터에 액세스하는 경우 IA 대비 최대 68%의 스토리지 비용을 절감
  - Flexible Retrieval (구 Glacier) : 즉각적인 액세스가 필요하지 않지만 (수십분 ~ 수시간) 비용 없이 큰 데이터 집합을 검색하는 유연성이 필요한 아카이브 데이터(예: 백업 또는 재해 복구 사용 사례)
- Amazon S3 Glacier Deep Archive : 인출하는데 최소 4시간이 소요될 수 있으며 법규 등에 의해 7년 ~ 10년간 보관해야하는 경우 해당 장기 아카이브 스토리지가 유용할 수 있다. (내구성 99.999999999%, 데이터 복원에 최대 12시간 소요)

### S3 객체 버전 관리 (버저닝)
- 버저닝은 동일한 파일의 다양한 업데이트 상태를 관리하는 방법이다.
- 실수로 특정 파일을 삭제하거나 업데이트 한 경우, 직전 버전의 파일이 필요할 수 있는데, 이때 버저닝이 보험과 같은 역할을 담당한다.

### S3 객체 라이프 사이클 관리 ( 수명주기 규칙)
- 파일 이동 : 서로 다른 클래스 간에 객체를 이동시키는 규칙을 추가할 수 있다. 예를 들어 로그 파일 생성 후 일주일 경과 시 S3-IA 클래스로 이동시키는 것이다
- 파일 소멸 : 객체가 소멸된 후의 사항을 정의할 수 있다. 예를 들어, S3 에서 파일을 삭제한 경우, 삭제한 파일을 일정 기간 임시 보관하는 규칙을 추가할 수 있다.
- 백업 파일을 몇 년간 보관할지 혹은 특정 기간이 지난 파일을 S3 -> S3-IA -> S3 Glacier -> S3 Glacier Deep Archive 로 옮기는 규칙을 작성할 수 있다.

### S3 복제
- S3 복제 기능을 이용해 S3 버킷에 저장된 모든 파일을 복사하고 다른 버킷에 자동으로 저장할 수 있다.
- AWS 는 S3 복제를 두 가지 유형으로 제공한다.
  - 교차 리전 복제(CRR, Cross Region Replication) : 서로 다른 리전 간의 객체 복제에 사용된다. (외국으로 파일을 복제하는 경우 개인정보보호법 등을 고려해야함)
  - 동일 리전 복제(SRR, Same-Region Replication) : 동일 리전 내에서 객체 복제에 사용되며 객체 단위로 다른 AZ 에 복사하는 것을 말한다. (동기복제 가능)
<br/>
> 교차리전 복제 시 주의사항
> 1) 소스와 타깃 버킷에 버저닝 기능이 활성화돼 있어야 한다.
> 2) 복제에 사용할 타깃 리전을 지정해야 한다
> 3) S3 파일 복제를 위한 퍼미션 롤이 있어야 한다.
> 4) 소스 버킷에 Object Lock 이 활성화돼 있는 경우, 타깃 버킷도 Object Lock 이 활성화돼 있어야 한다.
> 5) 타깃 버킷 오너는 소스 버킷 오너에게 객체 복제 퍼미션을 부여해야 한다.
- 교차 리전 복제의 경우는 거리가 멀어서 동기화는 어려워 비동기로 복제되며 일반적으로 잘하지 않는다.
  <br/>
### S3 Glacier
- Glacier 는 장기보관 백업을 위한 저비용 클라우드 스토리지이며, 인출비용이 있으므로 입출력이 없는 경우에 적합하다
- Glacier 는 Glacier 와 Glaicer Deep Archive 두 가지 유형이 있으며 다양한 산업에서 다음과 같이 활용된다
<br/>
1. 자기 테이프 스토리지 대체
2. 헬스케어/생명과학/과학 데이터 저장 (주로 장기저장하는 데이터)
3. 미디어 자산 아카이빙/디지털 보관 (평소 미활용하는 영상 등)
4. 규제 정책에 따른 아카이빙/장기 백업 보관
<br/>
- 아카이브는 데이터를 위한 금고 역할을 수행하는 볼트(Vault) 에 저장된다.
- 볼트는 S3 의 버킷과 비슷한 개념의 저장소이자 아카이브용 컨테이너라 할 수 있다.
- 법정증거(포렌식) 으로 활용해야하는 경우, 볼트 잠금 정책에 WORM(Write Once Read Many) 규칙을 추가해 다른 사용자의 편집 또는 수정을 막을 수 있다.

### EBS (Elastic Block Store)
- EBS는 EC2 인스턴스를 위한 영구 스토리지 기능을 수행한다. (EC2 인스턴스의 수명주기를 넘어서서 존재 가능)
- EBS 볼륨은 고가용성, 고신뢰성 스토리지 볼륨으로 EC2 인스턴스의 부트 파티션으로 사용되거나 서버를 위한 하드 드라이브와 같은 기능을 수행하게 된다.
- 즉, 서버의 HDD 처럼 동작하며 부트볼륨, 데이터베이스를 설치할 수 있고 데이터 볼륨을 별도로 관리할 수 있어 편리하다
- EBS 는 볼륨에 대한 특정 시점의 스냅샷을 지속적으로 작성해 S3 에 저장하는 방식으로 다수의 AZ 에서 자동 복제 기능을 제공한다.
- HDD 보다 더 빠른 SSD 를 사용할 수 있고, 더 빠른 Provisioned IOPS SSD 를 사용할 수 도 있다. (IO 성능이 중요한 워크로드에 사용하며 성능 예측가능하며 일관성 요구에 맞는 볼륨 타입이다.)

### EBS 특징
- 영구 스토리지 : EC2 인스턴스의 수명주기와 독립적인 생애주기를 갖는다.
- 범용성 : 특정 포맷 형식을 따르지 않는 블록 스토리지로 어떤 OS 에서도 사용할 수 있다.
- 고가용성 및 고신뢰성 : EBS 볼륨은 특정 컴포넌트 실패 시 동일 AZ 내에서 자동으로 복제하는데, 서로 다른 AZ 간에는 복제되지 않으며 동일 AZ 내 다른 서버 간에는 복제가 가능하다.
- 암호화, 다양한 저장 용량, 사용 편의성, 실패 대응성을 제공한다.
- EBS HDD-기반 볼륨은 낮은 빈도의 입출력 및 저렴한 비용에 초점을 맞춘 콜드 HDD 와 중요한 워크로드를 위한 처리 성능 최적화 HDD 타입 등이 있다.

### EFS (Elastic File System)
- EFS 는 공유 파일 시스템으로서 다수의 인스턴스를 위한 공통 파일 시스템 역할을 수행할 수 있으며, 낮은 전송지연율로 다수의 인스턴스를 지원할 수 있다.
- EC2 인스턴스가 여러개인 경우, 파일 시스템이 다를 수 있다.
- EFS 는 호환성이 높고 (파일 시스템 인터페이스 제공 및 파일 시스템 액세스 시맨틱이 일반적인 파일시스템과 동일) 빠르다 (페타바이트 규모로 민첩하게 확장 가능)

### AWS Storage Gateway
- SGW 는 기존 환경에 가상머신 형태로 배포되며 이를 통해 기존의 애플리케이션, 스토리지 시스템, 디바이스를 스토리지에 연결할 수 있다.
- 표준 스토리지 프로토콜 인터페이스를 제공하므로 별다른 변경 작업 없이 기존의 앱에 연결할 수 있다.
- 게이트웨이는 온프레미스에서 AWS 로의 데이터 전송을 최적화하며 로컬 캐시로 전송 속도를 높여 애플리케이션에 원활하게 데이터를 공급할 수 있다.
- 다음 세 가지 스토리지 인터페이스를 지원한다.
  - 파일 게이트웨이 : S3 객체의 저장과 인출을 도우며 파일은 NFS 마운트 포인트를 통해 접근할 수 있다, 관련 메타데이터는 객체와 함께 S3에 저장된다.
  - 볼륨 게이트웨이 : 애플리케이션에 블록 프로토콜 기반의 디스크 볼륨을 제공한다, 캐시드 모드 (프라이머리 데이터는 S3 에 저장, 자주 접근하는 데이터는 로컬에 저장해 신속하게 참조) 또는 스토어드 모드 (전체 데이터는 로컬에 저장하고 비동기적인 백업 데이터만 S3 에 저장) 로 실행된다.
  - 테이프 게이트웨이 : 기존의 백업 애플리케이션과 워크플로우는 그대로 사용하고 필요에 따라 확장성을 지닌 가상 테이프를 추가해 사용하는 방식이다.

### Snowball 과 Snowmobile
- Snowball 은 페타바이트 규모의 데이터 이전을 위한 임포트/익스포트 도구다. 이를 이용하면 높은 보안성, 내충격성의 아마존 전용 NAS 디바이스를 활용할 수 있다.
- Snowmobile 은 엑사바이트 규모의 데이터 이전 서비스로 AWS 에 대규모 데이터를 임포트/익스포트하는데 사용된다.

